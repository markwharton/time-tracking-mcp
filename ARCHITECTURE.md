# Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER                                     â”‚
â”‚                   (Natural Language)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ "Just spent 2h on security review"
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLAUDE DESKTOP                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Natural Language Understanding                            â”‚ â”‚
â”‚  â”‚  â€¢ Parse intent from user message                          â”‚ â”‚
â”‚  â”‚  â€¢ Extract: task, duration, time, tags                     â”‚ â”‚
â”‚  â”‚  â€¢ Map to appropriate tool                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ MCP Protocol (JSON-RPC)
                             â”‚ log_time({task, duration, ...})
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TIME TRACKING MCP SERVER                            â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TOOL LAYER (src/tools/)                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚log_time  â”‚ â”‚ status   â”‚ â”‚check_hrs â”‚ â”‚ weekly   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚ report   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚        â”‚           â”‚            â”‚            â”‚          â”‚   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SERVICE LAYER (src/services/)                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ MarkdownManager  â”‚  â”‚ DurationParser â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ addEntry       â”‚  â”‚ â€¢ parseDurationâ”‚                â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getWeeklySummaryâ”‚  â”‚ â€¢ formatDurationâ”‚               â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ loadConfig     â”‚  â”‚                â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚            â”‚                    â”‚                         â”‚   â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  UTILITY LAYER (src/utils/)                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚date-utils â”‚ â”‚file-utils â”‚ â”‚tool-responseâ”‚              â”‚   â”‚
â”‚  â”‚  â”‚â€¢ parseDateâ”‚ â”‚â€¢ readFile â”‚ â”‚â€¢ createTextâ”‚              â”‚   â”‚
â”‚  â”‚  â”‚â€¢ parseTimeâ”‚ â”‚â€¢ writeFileâ”‚ â”‚â€¢ withError â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FILE SYSTEM STORAGE                            â”‚
â”‚                                                                   â”‚
â”‚  ~/Documents/time-tracking/                                      â”‚
â”‚    â”œâ”€â”€ helimods/                                                 â”‚
â”‚    â”‚   â”œâ”€â”€ config.json         â—„â”€â”€â”€ Company config              â”‚
â”‚    â”‚   â”œâ”€â”€ 2025-week-42.md     â—„â”€â”€â”€ Time entries                â”‚
â”‚    â”‚   â””â”€â”€ 2025-week-43.md                                       â”‚
â”‚    â””â”€â”€ clientx/                                                  â”‚
â”‚        â”œâ”€â”€ config.json                                           â”‚
â”‚        â””â”€â”€ 2025-week-42.md                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### 1. Logging Time

```
User: "2h on security review"
  â”‚
  â–¼
Claude: Parse â†’ {task: "security review", duration: "2h"}
  â”‚
  â–¼
MCP Tool: log_time({task, duration, tags: ["development"]})
  â”‚
  â–¼
MarkdownManager: 
  â€¢ Parse duration â†’ 2.0 hours
  â€¢ Get current time â†’ 14:30
  â€¢ Format entry â†’ "- 14:30 security review (2.0h) #development"
  â€¢ Find week file â†’ 2025-week-42.md
  â€¢ Append entry
  â€¢ Recalculate summary
  â”‚
  â–¼
File System: Write 2025-week-42.md
  â”‚
  â–¼
MarkdownManager: Load weekly summary
  â”‚
  â–¼
MCP Tool: Format response
  â”‚
  â–¼
Claude: "âœ“ Logged 2h... You're at 23.5h / 25h (94%)"
  â”‚
  â–¼
User: Sees confirmation
```

### 2. Checking Status

```
User: "Status check"
  â”‚
  â–¼
Claude: Map to status tool
  â”‚
  â–¼
MCP Tool: status()
  â”‚
  â–¼
MarkdownManager:
  â€¢ Get current week â†’ week 42
  â€¢ Read 2025-week-42.md
  â€¢ Parse all entries
  â€¢ Calculate totals
  â€¢ Group by commitment
  â”‚
  â–¼
MCP Tool: Format summary
  â”‚
  â–¼
Claude: "ğŸ“Š Week 42 Status: 23.5h / 25h..."
  â”‚
  â–¼
User: Sees status
```

## Component Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LAYERS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Interface Layer (Tools)                                    â”‚
â”‚  â€¢ Validates input                                          â”‚
â”‚  â€¢ Calls services                                           â”‚
â”‚  â€¢ Formats output                                           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Business Logic (Services)                                  â”‚
â”‚  â€¢ Parses data formats                                      â”‚
â”‚  â€¢ Reads/writes files                                       â”‚
â”‚  â€¢ Calculates summaries                                     â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Utilities (Utils)                                          â”‚
â”‚  â€¢ Date/time handling                                       â”‚
â”‚  â€¢ File I/O                                                 â”‚
â”‚  â€¢ Error handling                                           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Storage (Markdown Files)                                   â”‚
â”‚  â€¢ Human-readable                                           â”‚
â”‚  â€¢ Version controllable                                     â”‚
â”‚  â€¢ Portable                                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Module Dependencies

```
server.ts
  â”‚
  â”œâ”€â”€â–º tools/log-time.ts
  â”‚     â”‚
  â”‚     â”œâ”€â”€â–º services/markdown-manager.ts
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â”€â–º utils/file-utils.ts
  â”‚     â”‚     â”œâ”€â”€â–º utils/date-utils.ts
  â”‚     â”‚     â””â”€â”€â–º services/duration-parser.ts
  â”‚     â”‚
  â”‚     â”œâ”€â”€â–º services/duration-parser.ts
  â”‚     â”œâ”€â”€â–º utils/date-utils.ts
  â”‚     â””â”€â”€â–º utils/tool-response.ts
  â”‚
  â”œâ”€â”€â–º tools/status.ts
  â”‚     â”‚
  â”‚     â”œâ”€â”€â–º services/markdown-manager.ts
  â”‚     â””â”€â”€â–º utils/tool-response.ts
  â”‚
  â”œâ”€â”€â–º tools/check-hours.ts
  â”‚     â”‚
  â”‚     â”œâ”€â”€â–º services/markdown-manager.ts
  â”‚     â””â”€â”€â–º utils/tool-response.ts
  â”‚
  â””â”€â”€â–º tools/weekly-report.ts
        â”‚
        â”œâ”€â”€â–º services/markdown-manager.ts
        â””â”€â”€â–º utils/tool-response.ts
```

## Execution Flow

### Initialization (Startup)

```
1. Load package.json (version info)
2. Import all tools
   â””â”€â–º Each tool calls registerTool()
       â””â”€â–º Adds to toolRegistry
3. Create MCP Server instance
4. Set up request handlers
   â”œâ”€â–º ListTools: Return all registered tools
   â””â”€â–º CallTool: Execute tool by name
5. Connect stdio transport
6. Wait for requests
```

### Request Handling (Runtime)

```
1. Claude sends CallTool request
   â”œâ”€â–º tool name
   â””â”€â–º arguments

2. Server receives request
   â””â”€â–º Look up tool in registry

3. Execute tool handler
   â”œâ”€â–º Validate arguments
   â”œâ”€â–º Call service layer
   â”œâ”€â–º Process data
   â””â”€â–º Return response

4. Server sends response
   â””â”€â–º Formatted text content

5. Claude presents to user
```

## State Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MCP SERVER (Stateless)                                     â”‚
â”‚  â€¢ No memory between calls                                  â”‚
â”‚  â€¢ Each request independent                                 â”‚
â”‚  â€¢ Tools registered at startup                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Reads/Writes
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FILE SYSTEM (State Storage)                                â”‚
â”‚  â€¢ Markdown files = source of truth                         â”‚
â”‚  â€¢ Config files = settings                                  â”‚
â”‚  â€¢ No database needed                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Error Handling Flow

```
User Input
  â”‚
  â–¼
Tool Handler (withErrorHandler wrapper)
  â”‚
  â”œâ”€â”€â–º Try
  â”‚     â”‚
  â”‚     â”œâ”€â”€â–º Service Layer
  â”‚     â”‚     â”‚
  â”‚     â”‚     â”œâ”€â”€â–º Try
  â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚     â”œâ”€â”€â–º File Operations
  â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚     â””â”€â”€â–º Throw specific error
  â”‚     â”‚     â”‚
  â”‚     â”‚     â””â”€â”€â–º Catch & re-throw
  â”‚     â”‚
  â”‚     â””â”€â”€â–º Return success response
  â”‚
  â””â”€â”€â–º Catch
        â”‚
        â””â”€â”€â–º createErrorResponse(error)
              â”‚
              â””â”€â”€â–º Return error message to user
```

## Configuration Flow

```
Environment Variables (Claude config)
  â”‚
  â”œâ”€â–º TIME_TRACKING_DIR â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”œâ”€â–º COMPANIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”œâ”€â–º DEFAULT_COMPANY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”œâ”€â–º DISPLAY_TIMEZONE_OFFSET â”€â”€â”€â”¤
  â””â”€â–º DISPLAY_TIMEZONE_STRING â”€â”€â”€â”¤
                                 â”‚
                                 â–¼
                    config/environment.ts
                                 â”‚
                                 â–¼
                         Services & Tools
                                 â”‚
                                 â–¼
                    ~/Documents/time-tracking/
                      {company}/config.json
                                 â”‚
                                 â–¼
                      Business Logic (commitments, projects)
```

## Performance Characteristics

```
Operation              Complexity    Typical Time
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Read week file         O(1)          < 1ms
Parse entries          O(n)          < 1ms (n=50)
Calculate summary      O(n)          < 1ms (n=50)
Write file             O(1)          < 5ms
Total log_time         O(n)          < 10ms

Where n = number of entries per week (typically < 100)
```

## Scalability Limits

```
File Size:
  Typical week: 5 KB (50 entries)
  Max practical: 100 KB (1000 entries)
  Performance: Linear, always fast

Companies:
  Limited by: File system / user organization
  Practical: < 10 companies
  Each isolated: No cross-talk

History:
  Years of data: < 5 MB
  Read time: Only current week loaded
  No degradation: Past data unused
```

## Security Boundaries

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude Desktop (Trusted)                       â”‚
â”‚  â€¢ User's local app                             â”‚
â”‚  â€¢ Full access to MCP server                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ MCP Protocol (local)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MCP Server (Trusted)                           â”‚
â”‚  â€¢ Runs as user                                 â”‚
â”‚  â€¢ File system permissions                      â”‚
â”‚  â€¢ No network access                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ File I/O
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  File System (User's data)                      â”‚
â”‚  â€¢ ~/Documents/time-tracking/                   â”‚
â”‚  â€¢ User ownership                               â”‚
â”‚  â€¢ OS-level permissions                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

No external services, no authentication needed
```

---

This architecture prioritizes:
- âœ… **Simplicity** - Easy to understand
- âœ… **Reliability** - Minimal failure points
- âœ… **Performance** - Fast operations
- âœ… **Maintainability** - Clear separation of concerns
- âœ… **User Control** - Local data, editable files